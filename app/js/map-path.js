$(function () {

  var imagePath = "./images/";
  var timerRemove;
  var paths = {
    Starominsky: {
      name: 'Староминской',
      path: "M290.29,141a8.44,8.44,0,0,1-2.13-.52c-1.75-.58-3.17-1-4.43-1.31a24.63,24.63,0,0,1-8.46-3.64,14.74,14.74,0,0,1-2.87-2.38c-1.32-1.38-1.84-1.7-7.27-1.7h-.8c-3.15,0-5.75,0-7.8,0l-3.33,0H252a3.83,3.83,0,0,0,.46-3.59c-.3-1-.65-1.89-1-2.76-.84-2.17-1.56-4-1-6,.79-2.76.95-3.34,4.69-4.67,4.08-1.45,5.21-3.13,5.25-3.2a12,12,0,0,0,2.07-4.18,3.62,3.62,0,0,0-.9-2.5,3.42,3.42,0,0,1-.54-1h0a2.76,2.76,0,0,1,1.06-.13l.84,0a11.22,11.22,0,0,1,4.38,1.2,4.68,4.68,0,0,0,1.94.6,3.11,3.11,0,0,0,2-.92,7.37,7.37,0,0,1,3.32-1.85,5.56,5.56,0,0,0,5.27,4,7.59,7.59,0,0,0,3.59-.73,3.62,3.62,0,0,1,1.79-.43,10.41,10.41,0,0,1,1.63.16,16.54,16.54,0,0,0,2.55.26,3,3,0,0,0,2.26-.72c.57-.58.79-1.46.77-3a4.58,4.58,0,0,1,1.14-3.37,4.17,4.17,0,0,1,3.1-1.12H297c2.71.1,3.6.9,3.52,5.49a51.26,51.26,0,0,0,1,13.11,33.26,33.26,0,0,0,1.24,4.29c.83,2.4,1.28,3.72-.12,5.27-.73.81-1.06.81-1.17.81h0a1.51,1.51,0,0,1-.37-.07,2.33,2.33,0,0,0-.62-.1c-.85,0-1.68.7-2.88,2.4a11.19,11.19,0,0,1-5.28,3.67c-1.91.81-3.71,1.58-3.81,3.59a8,8,0,0,0,1.27,3.94,8.09,8.09,0,0,1,.54,1.13Z"
    },
    Kanevskoy: {
      name: 'Каневской',
      path: "M299.78,194.5c.37-.9.82-2.38.27-3.29a1.67,1.67,0,0,0-1.55-.75,3.81,3.81,0,0,0-.58,0c-.7.11-1.5.27-2.39.46a39.8,39.8,0,0,1-8.05,1.06,17.88,17.88,0,0,1-4.35-.5,36.68,36.68,0,0,0-6-.88c-2.84-.25-4.89-.43-5.73-1.89-.19-.33-.34-.61-.48-.86-1.06-1.94-1.29-2-5.25-2.33l-.66-.06a10.39,10.39,0,0,1-5.21-2.27,12.15,12.15,0,0,0-7.69-2.74H252c-5.36.06-6.57,2-6.85,2.85a1.83,1.83,0,0,0,.55,2.05l.37.27c2.93,2.13,3.46,3.05,3.39,3.45,0,.2-.39.34-.6.4-1.25.37-1.88,1.66-2.39,2.7-.3.61-.67,1.38-1,1.38s-1.13-.5-3.06-3.85c-5-8.63-6.83-11.7-10.07-15.1-2.9-3-7.42-10.11-7.9-10.86a9.26,9.26,0,0,1,0-4.64c.25-.75.81-1.06,1.59-1.48a5.87,5.87,0,0,0,3.43-4.57,72.46,72.46,0,0,0,.94-12.24c0-1.08,0-2,.07-2.85.19-4.58.57-5.43.72-5.58.62-.16,12.9-2,16.15-2a2.55,2.55,0,0,1,.52,0c.34.08.69.18,1.07.3a15.28,15.28,0,0,0,4.7.78c.43,0,.9,0,1.39-.06,1-.09,2.84-.13,5.4-.13,3.94,0,8.46.11,9.38.13a37.22,37.22,0,0,0,6,4c.66.29,1.56.74,2.51,1.23a43.8,43.8,0,0,0,5.53,2.51,3.14,3.14,0,0,0-2.31,1.63,2.83,2.83,0,0,0,.24,2.48,7.23,7.23,0,0,1,.73,3.68,5.26,5.26,0,0,1-.92,2.9c-.78,1.29-1.14,2.19,1.07,4.46,1.58,1.62,3.78,1.84,5.72,1.84l1.34,0,1.16,0c1.72,0,2.44.27,2.67,1a6.33,6.33,0,0,1-.57,4.26c-.42,1.08-.78,2-.4,2.81.26.55.19.68-.13,1.27a7.88,7.88,0,0,0-.91,2.41c-.23,1.1-.6,2.39-1,3.64a27.11,27.11,0,0,0-1,4.43l0,.2c-.16,2,.06,3.43,4.41,4.33a11.17,11.17,0,0,0,2.27.25,9.29,9.29,0,0,0,4.31-1.19,17.85,17.85,0,0,1,2.67-1.08,6.46,6.46,0,0,0,3.19-2.12A4.79,4.79,0,0,1,310,174.5c.36,0,.73,0,1.11,0a21.43,21.43,0,0,1,8.54,1.94,12.73,12.73,0,0,1,.7,2.36,10.53,10.53,0,0,0,1.23,3.57c.33.44-.14,3.27-1,6.27-1.33.37-5.32,1.62-6.05,3.2-.43.93-4.1,2.14-6.6,2.71Z"
    }
  }
  var r = Raphael('map', '100%'),
    attributes = {
      fill: '#bed8e6',
      stroke: '#fff',
      'stroke-width': 1,
      'stroke-linejoin': 'round'
    },
    arr = new Array();
  for (var country in paths) {
    var obj = r.path(paths[country].path);
    obj.attr(attributes);
    arr[obj.id] = country;
    obj
      .hover(function () {
        clearTimeout(timerRemove);
        $('#' + arr[this.id]).addClass('selected');
        this.animate({
          fill: '#1669AD',
          'stroke-width': 3,
        }, 100);
      }, function () {
        this.animate({
          fill: attributes.fill,
          'stroke-width': attributes["stroke-width"]
        }, 100);
      })
      .hover(function (e) {
        clearTimeout(timerRemove);
        $('#' + arr[this.id]).addClass('selected');

        var point = this.getBBox(0);

        $('#map').next('.point').remove();
        $('#map').after($('<div />').addClass('point'));
        $('.point')
          .prepend($('<img />').attr('src', imagePath + arr[this.id] + '.png'))
          .css({
            left: point.x,
            top: point.y
          })
          .fadeIn(100);
      })
      .mouseout(function () {
        timerRemove = setTimeout(function () {
          $('.point').fadeOut(100, function () {
            $('.point').remove();
          });
        }, 10);
      })
  }
  //when city links hovered;
  (function () {
    var obj;
    $('.city-list a').hover(function () {
      obj = r.path(paths[$(this).attr('id')].path);
      obj.attr(attributes);
      obj.animate({
        fill: '#1669AD',
        'stroke-width': 3,
      }, 100);
    }, function () {
      obj.animate({
        fill: attributes.fill,
        'stroke-width': attributes["stroke-width"]
      }, 100);

    }).hover(function () {
      var point = obj.getBBox(0);

      $('#map').next('.point').remove();
      $('#map').after($('<div />').addClass('point'));
      $('.point')
        .prepend($('<img />').attr('src', imagePath + $(this).attr('id') + '.png'))
        .css({
          left: point.x,
          top: point.y
        })
        .fadeIn(100);
    }, function () {
      $('.point').fadeOut(100, function () {
        $('.point').remove();
      });
    })
  })()

});